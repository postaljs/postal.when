/**
 * postal.when - A postal.js add-on enabling an aggregated response to a group of messages.
 * Author: Jim Cowart (http://freshbrewedcode.com/jimcowart)
 * Version: v0.2.0
 * Url: http://github.com/postaljs/postal.when
 * License(s): MIT
 */
(function(t,n){"object"==typeof module&&module.exports?module.exports=function(t){return n(require("underscore"),t,this)}:"function"==typeof define&&define.amd?define(["underscore","postal"],function(e,o){return n(e,o,t)}):t.postal=n(t._,t.postal,t)})(this,function(t,n,e,o){var i=function(e,i,u,c){var a,r=this,s="[object Function]"===Object.prototype.toString.call(u)?u:function(){},f="[object Object]"===Object.prototype.toString.call(u)?u:c||{},p=[],d=function(){f.timeout&&(a=setTimeout(function(){s({type:"timeout",data:t.pluck(p,"data")})},f.timeout))},l=function(){t.each(p,function(t){t.data=o})},b=function(){var n=t.pluck(p,"data");t.all(n,t.identity)&&(clearTimeout(a),i.apply(this,n),f.once?r.dispose():(l(),d()))};r.dispose=function(){t.each(p,function(t){t.unsubscribe()}),p=[]},t.each(e,function(t){var e=n.subscribe(t);e.data=o,e.subscribe(function(t){e.data=t,b()}),p.push(e)}),d()};return n.when=function(t,n,e,o){return new i(t,n,e,o)},n});